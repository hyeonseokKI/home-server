server {
    listen 80;
    server_name _;

    root /usr/share/nginx/html;
    index index.html;

    # 404 에러 페이지 설정
    # Next.js 정적 export는 not-found.tsx를 404.html로 빌드함
    error_page 404 /404.html;

    # 정적 파일 및 디렉토리 처리
    location / {
        # 1. 실제 파일 확인 ($uri)
        # 2. 디렉토리 확인 ($uri/) - trailingSlash: true로 인해 디렉토리 형태로 빌드됨
        # 3. 존재하지 않으면 404 반환 → error_page로 404.html 표시
        try_files $uri $uri/ =404;
    }

    # 404.html 직접 접근 허용 및 Content-Type 명시
    location = /404.html {
        # HTML로 서빙
        add_header Content-Type "text/html; charset=utf-8";
    }

    # 캐시 최적화
    location /_next/ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }

}
